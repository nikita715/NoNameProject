<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

<head>
    <title>Shelf</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link th:href="@{/css/style.css}" href="../static/css/style.css" rel="stylesheet" type="text/css" />
    <link th:href="@{/img/favicon.png}" rel="icon" type="image/png" href="../static/img/favicon.png" />
</head>

<body>
<header class="main-header">
    <a class="main-header-site-link" th:href="@{'/'+${user.name}}">
        <img class="site-logo" th:src="@{/img/site-logo-main.png}" src="../static/img/site-logo-main.png" width="103" height="50" />
    </a>
    <button class="user-nav-opener" th:text="${user.name}"></button>
    <nav class="user-nav">
        <a href="#">Settings</a>
        <a href="#">Help</a>
        <a th:href="@{/exit}">Exit</a>
    </nav>
</header>
<main class="tasks-page">
    <aside class="tasks-navigation">
        <a th:classappend="${tasksSelector == 'today'} ? tasks-selector-current : ''" class="tasks-selector" id="tasks-selector-today" href="#" th:href="@{'/'+${user.name}+'/today'}">Today</a>
        <a th:classappend="${tasksSelector == 'tomorrow'} ? tasks-selector-current : ''" class="tasks-selector" id="tasks-selector-tomorrow" href="#" th:href="@{'/'+${user.name}+'/tomorrow'}">Tomorrow</a>
        <a th:classappend="${tasksSelector == 'week'} ? tasks-selector-current : ''" class="tasks-selector" id="tasks-selector-week" href="#" th:href="@{'/'+${user.name}+'/week'}">Week</a>
        <a th:classappend="${tasksSelector == 'unfinished'} ? tasks-selector-current : ''" class="tasks-selector" id="tasks-selector-old" href="#" th:href="@{'/'+${user.name}+'/unfinished'}">Unfinished</a>
        <a th:classappend="${tasksSelector == 'completed'} ? tasks-selector-current : ''" class="tasks-selector" id="tasks-selector-completed" href="#" th:href="@{'/'+${user.name}+'/completed'}">Completed</a>
        <a th:each="category : ${categoriesSet}" th:text="${category.name}" th:href="@{'/'+${user.name}+'/category/'+${category.id}}" href="#">Category</a>
    </aside>
    <section class="tasks">
        <h4 class="task-add-opener">Add new task</h4>
        <form th:object="${task}" th:action="@{'/'+${user.name}+'/add'}" class="task-add" id="task-add" method="post">
            <h2>Add new task</h2>
            <input th:field="*{name}" class="task-add-name" type="text" name="taskName" value="" placeholder="Task name" maxlength="30" />
            <input th:field="*{endDate}" class="task-add-date" type="date" name="taskDate" />
            <div class="task-add-submit-container">
                <input class="task-add-submit" type="submit" />
            </div>
            <input th:field="*{description}" class="task-add-details" name="taskDetails" value="" placeholder="Task details" />
            <select th:field="*{priority}" class="task-add-priority" name="taskPriority" form="task-add">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </form>
        <div class="tasks-empty" th:if="${tasksSelector == 'today'} or ${tasksSelector == 'initial'} and ${#sets.isEmpty(datedTasksSet)}">You don't have tasks for today</div>
        <div class="tasks-empty" th:if="${tasksSelector == 'tomorrow'} and ${#sets.isEmpty(datedTasksSet)}">You don't have tasks for tomorrow</div>
        <div class="tasks-empty" th:if="${tasksSelector == 'week'} and ${#sets.isEmpty(datedTasksSet)}">You don't have tasks for this week</div>
        <div class="tasks-empty" th:if="${tasksSelector == 'unfinished'} and ${#sets.isEmpty(datedTasksSet)}">You don't have overdue tasks</div>
        <div class="tasks-empty" th:if="${tasksSelector == 'completed'} and ${#sets.isEmpty(datedTasksSet)}">You don't have completed tasks</div>
        <div th:each="currentDateSet : ${datedTasksSet}" th:attr="class=${currentDateSet.completed} ? 'tasks-completed tasks-group' : 'tasks-group'" th:classappend="${currentDateSet.overdue} ? 'tasks-overdue'" class="tasks-group">
            <h3 th:text="${currentDateSet.time}" class="tasks-group-date">December, 28</h3>
            <div th:each="task : ${currentDateSet.tasks}" th:class="'task task-priority-' + ${task.priority}" class="task">
                <span th:text="${task.name}" class="task-name">Some task</span>
                <button class="task-details-button">Описание</button>
                <span th:text="${task.endDate}" class="task-time">Dec 28</span>
                <div class="task-complete-button-container">
                    <a class="task-complete-button" th:href="@{'/' + ${user.name} + '/complete/' + ${task.id}}">Выполнено</a>
                </div>
                <p th:text="${task.description}" class="task-details">details</p>
                <a class="task-delete" th:href="@{'/' + ${user.name} + '/delete/' + ${task.id}}">&times;</a>
            </div>
            <h4 sec:authentication="name" th:if="!${currentDateSet.completed} and !${currentDateSet.overdue}" class="task-add-opener">Add new task</h4>
            <form th:if="!${currentDateSet.completed} and !${currentDateSet.overdue}" th:object="${task}" th:action="@{'/' + ${user.name} + '/add'}" class="task-add" id="task-add" method="post">
                <h2>Add new task</h2>
                <input th:field="*{name}" class="task-add-name" type="text" name="taskName" value="" placeholder="Task name" maxlength="30" />
                <input th:field="*{endDate}" class="task-add-date" type="date" name="taskDate" />
                <div class="task-add-submit-container">
                    <input class="task-add-submit" type="submit" />
                </div>
                <input th:field="*{description}" class="task-add-details" name="taskDetails" value="" placeholder="Task details" />
                <select th:field="*{priority}" class="task-add-priority" name="taskPriority" form="task-add">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </form>
        </div>
    </section>
</main>
<!--<div class="settings-mask">-->
<!--<div class="settings">-->

<!--</div>-->
<!--</div>-->
<script src="../static/js/libs/jquery-3.1.1.js" th:src="@{/js/libs/jquery-3.1.1.js}"></script>
<script src="../static/js/js.js" th:src="@{/js/js.js}"></script>
</body>

</html>